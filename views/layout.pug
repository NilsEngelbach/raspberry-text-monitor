doctype html
html(translate="no")

  head
    title Setlist
    meta(name='viewport' content='width=device-width, initial-scale=1')
    link(href='/public/app.css' rel='stylesheet')
    link(href='/public/favicon.ico' rel='icon')

  body(style=css)
    #container
      block content

    #footer
      block footer

    script.
      const timeout = 300;

      var left = 0;
      var left_timeout = undefined;

      var middle = 0;
      var middle_timeout = undefined;

      var right = 0;
      var right_timeout = undefined;

      function keyEvents(event) {

        console.log(event);

        if (event.keyCode === #{keycodes.left}) {
          left++
          if (left >= 2) {
            if (left_timeout) {
              clearTimeout(left_timeout);
            }
            window.dispatchEvent(new CustomEvent("double", { detail: { button: "left" } }));
            left = 0;
            return;
          }
          left_timeout = setTimeout(() => {
            window.dispatchEvent(new CustomEvent("single", { detail: { button: "left" } }));
            left = 0;
          }, timeout);
        }

        if (event.keyCode === #{keycodes.middle}) {
          middle++
          if (middle >= 2) {
            if (middle_timeout) {
              clearTimeout(middle_timeout);
            }
            window.dispatchEvent(new CustomEvent("double", { detail: { button: "middle" } }));
            middle = 0;
            return;
          }
          middle_timeout = setTimeout(() => {
            window.dispatchEvent(new CustomEvent("single", { detail: { button: "middle" } }));
            middle = 0;
          }, timeout);
        }

        if (event.keyCode === #{keycodes.right}) {
          right++
          if (right >= 2) {
            if (right_timeout) {
              clearTimeout(right_timeout);
            }
            window.dispatchEvent(new CustomEvent("double", { detail: { button: "right" } }));
            right = 0;
            return;
          }
          right_timeout = setTimeout(() => {
            window.dispatchEvent(new CustomEvent("single", { detail: { button: "right" } }));
            right = 0;
          }, timeout);
        }
      }

      document.addEventListener('keyup', keyEvents, true)

    block scripts